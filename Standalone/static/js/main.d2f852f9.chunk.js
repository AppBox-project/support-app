(this["webpackJsonpsupport-dashboard"]=this["webpackJsonpsupport-dashboard"]||[]).push([[0],{32:function(e,t,n){e.exports={input:"styles_input__Awl1k"}},33:function(e,t,n){e.exports={picture:"styles_picture__jko9n",xs:"styles_xs__3-13V",withShadow:"styles_withShadow__3518o",sm:"styles_sm__1s8n9",md:"styles_md__1IDal",lg:"styles_lg__3X1oC",xl:"styles_xl__3_9tj"}},42:function(e,t,n){e.exports={root:"styles_root__1Fa0k",hoverable:"styles_hoverable__31MfH",image:"styles_image__1F_oo"}},46:function(e,t,n){e.exports={root:"styles_root__2w3r0"}},47:function(e,t,n){e.exports={root:"Layout_root__27KTH"}},56:function(e,t,n){},62:function(e,t,n){"use strict";n.r(t);var c={};n.r(c),n.d(c,"layout",(function(){return X})),n.d(c,"home",(function(){return G})),n.d(c,"default",(function(){return Q}));var a=n(2),o=n(0),i=n.n(o),s=n(18),r=n.n(s),l=(n(56),n(16)),u=n(9),d=n(41),j=function(e,t){return new Promise((function(n,c){fetch(e,{method:"POST",mode:"cors",cache:"no-cache",credentials:"same-origin",headers:{"Content-Type":"application/json"},redirect:"follow",referrerPolicy:"no-referrer",body:JSON.stringify(t||{})}).then((function(e){return e.json()})).then((function(e){n(e)}))}))},O=n(82),b=n(34),h=n(81),p=n(83),g=n(42),f=n.n(g),m=function(e){var t=e.children,n=(e.withBigMargin,e.title),c=e.withoutPadding,o=e.centerTitle,i=e.titleDivider;return Object(a.jsx)("div",{className:"Card ".concat(f.a.root),children:Object(a.jsxs)("div",{style:{padding:!c&&15},children:[n&&Object(a.jsxs)(a.Fragment,{children:[Object(a.jsx)(b.a,{variant:"h6",style:{textAlign:o?"center":"left"},children:n}),i&&Object(a.jsx)(h.a,{style:{marginBottom:10,marginTop:5}})]}),t]})})},_=n(90),x=n(32),S=n.n(x),y=function(e){var t=e.placeholder,n=e.label,c=e.value,i=e.onChange,s=e.type,r=e.style,d=e.autoFocus,j=e.readOnly,O=e.onEnter,b=e.onEscape,h=e.onKeyPress,p=e.name,g=e.spacing,f=(e.startAdornment,e.endAdornment,Object(o.useState)("")),m=Object(u.a)(f,2),x=m[0],y=m[1];return Object(o.useEffect)((function(){y(c)}),[c]),"textarea"===s?Object(a.jsx)(_.a,{"aria-label":"minimum height",rowsMin:3,placeholder:n,value:x,onChange:function(e){y(e.target.value),i&&i(e.target.value)},className:S.a.input}):n?Object(a.jsx)("div",{style:{marginBottom:g&&5*g,marginTop:g&&5*g},children:Object(a.jsxs)("label",{style:{width:"100%"},children:[n,Object(a.jsx)("input",{name:p,autoFocus:d,style:r,type:s||"text",className:S.a.input,placeholder:t,disabled:j||!1,value:x,onChange:function(e){y(e.target.value),i&&!j&&i(e.target.value)},onKeyDown:function(e){h&&h(x),"Enter"===e.key&&O&&O(x),"Escape"===e.key&&b&&b(x)}})]})}):Object(a.jsx)("input",{style:Object(l.a)(Object(l.a)({},r),{},{marginBottom:g&&5*g,marginTop:g&&5*g}),name:p,className:S.a.input,type:s||"text",placeholder:t,value:x,disabled:j||!1,autoFocus:d,onChange:function(e){y(e.target.value),i&&!j&&i(e.target.value)},onKeyDown:function(e){h&&h(x),"Enter"===e.key&&O&&O(x),"Escape"===e.key&&b&&b(x)}})},v=n(46),T=n.n(v),E=function(e){var t=e.config,n=e.api,c=Object(o.useState)({username:"",password:""}),i=Object(u.a)(c,2),s=i[0],r=i[1],d=Object(o.useState)(),j=Object(u.a)(d,2),g=j[0],f=j[1];return Object(a.jsx)(O.a,{container:!0,direction:"row",justify:"center",alignItems:"center",className:T.a.root,style:{backgroundImage:"url(".concat(t.login.background,")"),backgroundColor:"rgba(".concat(t.color.r,",").concat(t.color.g,",").concat(t.color.b,",0.6)")},children:Object(a.jsx)(O.a,{item:!0,xs:12,md:3,children:Object(a.jsxs)(m,{title:t.app_name,children:[Object(a.jsx)(b.a,{variant:"body1",children:t.login.welcomeText||"Log into ".concat(t.app_name," using your appbox credentials.")}),g&&Object(a.jsxs)(a.Fragment,{children:[Object(a.jsx)(h.a,{style:{margin:"5px 0"}}),Object(a.jsxs)(b.a,{variant:"body2",style:{color:"red"},children:[Object(a.jsx)("b",{children:"Error: "}),g]}),Object(a.jsx)(h.a,{style:{margin:"5px 0"}})]}),Object(a.jsx)(y,{label:"Username",value:s.username,onChange:function(e){return r(Object(l.a)(Object(l.a)({},s),{},{username:e}))},style:{marginTop:15}}),Object(a.jsx)(y,{label:"Password",value:s.password,type:"password",onChange:function(e){return r(Object(l.a)(Object(l.a)({},s),{},{password:e}))},style:{marginTop:15}}),Object(a.jsx)(p.a,{fullWidth:!0,variant:"contained",color:"primary",style:{marginTop:15},onClick:function(){n.signIn(s).then((function(e){console.log(e)}),(function(e){return f(e)}))},children:"Sign in"})]})})})},w=n(84),k=function(e){var t=e.label;return Object(a.jsxs)("div",{className:"center",style:{width:"100%",height:"100%"},children:[Object(a.jsx)(w.a,{}),t&&Object(a.jsxs)(a.Fragment,{children:[Object(a.jsx)("br",{}),t]})]})},C=n(31),P=n(26),A=n(7),R=n(85),I=n(48),N=new function e(){var t=this;Object(d.a)(this,e),this.key=void 0,this.url=Object({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}).REACT_APP_URL,this.appCode=Object({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}).REACT_APP_STANDALONE_SECRET,this.token=void 0,this.auth=void 0,this.user=void 0,this.person=void 0,this.config=void 0,this.signIn=function(e){return new Promise((function(n,c){j("".concat(t.url,"/api/system/signIn"),{user:e,standAloneCode:t.appCode}).then((function(e){console.log("API feedback",e),e.success?(t.setToken(e.token,e.username),localStorage.setItem("token",e.token),localStorage.setItem("username",e.username),n(e.token)):c(e.reason)}))}))},this.setToken=function(e,n){t.token=e,t.auth={token:e,username:n,signInAs:"person"}},this.getPerson=function(){return new Promise((function(e,n){j("".concat(t.url,"/api/people/read?email=").concat(t.auth.username),{auth:t.auth}).then((function(n){e(n[0]),t.person=n[0]}))}))},this.getObjects=function(e,n){return new Promise((function(c,a){j("".concat(t.url,"/api/").concat(e,"/read?").concat(n),{auth:t.auth}).then((function(e){c(e)}))}))}},D=function(e){var t=e.pages,n=Object(o.useState)(),c=Object(u.a)(n,2),i=c[0],s=c[1],r=Object(o.useState)(),d=Object(u.a)(r,1)[0],j=Object(o.useState)(),O=Object(u.a)(j,2),b=O[0],h=O[1],p=Object(o.useState)(!0),g=Object(u.a)(p,2),f=g[0],m=g[1];return Object(o.useEffect)((function(){!function(e){var t=Object({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}).REACT_APP_URL,n=Object({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}).REACT_APP_STANDALONE_SECRET,c=localStorage.getItem("config");c?(e(JSON.parse(c)),fetch("".concat(t,"/api/system/standalone/").concat(n)).then((function(e){return e.json()})).then((function(t){JSON.parse(c).configVersion!==t.configVersion&&(localStorage.setItem("config",JSON.stringify(t)),e(t))}),(function(t){e(t)}))):fetch("".concat(t,"/api/system/standalone/").concat(n)).then((function(e){return e.json()})).then((function(t){localStorage.setItem("config",JSON.stringify(t)),e(t)}),(function(t){e(t)}))}((function(e){s(e),N.config=e})),d||b||(N.setToken(localStorage.getItem("token"),localStorage.getItem("username")),N.token?"people"===(N.config.signInWith||"people")?N.getPerson().then((function(e){h(e),m(!1)})):console.log("Todo: sign in user"):m(!1))}),[d,b]),Object(a.jsx)(R.a,{theme:Object(I.a)({palette:{type:window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"}}),children:i?i.requireSignIn?d||b?Object(a.jsx)(t.layout,{api:N,children:Object(a.jsx)(P.a,{children:Object(a.jsxs)(A.c,{children:[Object(C.map)(t.default,(function(e,t){return Object(a.jsx)(A.a,{path:"/".concat(t,"/:detailId?"),render:function(t){return Object(a.jsx)(e,Object(l.a)(Object(l.a)({},t),{},{detailId:t.match.params.detailId,api:N}))}},t)})),Object(a.jsx)(A.a,{path:"/",children:Object(a.jsx)(t.home,{api:N})})]})})}):f?Object(a.jsx)(k,{}):Object(a.jsx)(E,{config:i,api:N}):Object(a.jsx)(t.layout,{api:N,children:"Test"}):Object(a.jsx)(k,{})})},L=n(47),H=n.n(L),K=function(e){var t=e.api,n=e.children;return Object(a.jsx)(O.a,{container:!0,direction:"row",justify:"center",alignItems:"center",className:H.a.root,style:{backgroundImage:"url(".concat(t.config.login.background),backgroundColor:"rgba(".concat(t.config.color.r,",").concat(t.config.color.g,",").concat(t.config.color.b,",0.6)")},children:Object(a.jsx)(O.a,{item:!0,xs:12,md:8,children:n})})},W=n(86),F=n(87),B=n(91),U=n(88),M=n(89),V=n(33),J=n.n(V),z=function(e){var t=e.size,n=e.withShadow,c=e.image,o=(e.shadowRadius,e.className),i=e.style,s=e.fallBackOnLocalhost;return Object(a.jsx)("div",{className:"".concat(J.a[t]).concat(o?" ".concat(o):""),style:i,children:Object(a.jsx)("div",{className:"".concat(J.a.picture," ").concat(n&&J.a.withShadow),style:{backgroundImage:s?(null===c||void 0===c?void 0:c.match("localhost"))?"url(https://picsum.photos/200)":"url(".concat(c,")"):"url(".concat(c||"https://picsum.photos/seed/13/300/400",")")}})})},Y=function(e){var t=e.api,n=e.ticket,c=Object(o.useState)(),i=Object(u.a)(c,2),s=i[0],r=i[1];return Object(o.useEffect)((function(){t.getObjects("support-responses","ticket=".concat(n._id)).then((function(e){return r(e)}))}),[n,t]),Object(a.jsxs)(O.a,{item:!0,xs:12,sm:9,className:"scrollIndependently",children:[Object(a.jsx)(m,{withBigMargin:!0,children:Object(a.jsxs)(O.a,{container:!0,children:[Object(a.jsxs)(O.a,{item:!0,xs:12,sm:3,style:{textAlign:"center"},children:[Object(a.jsx)(z,{withShadow:!0,size:"sm",style:{margin:"0 auto"},image:"".concat(Object({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}).REACT_APP_URL,"/").concat(t.person.data.picture.url),fallBackOnLocalhost:!0}),Object(a.jsx)(b.a,{variant:"body1",children:t.person.data.full_name})]}),Object(a.jsx)(h.a,{orientation:"vertical",flexItem:!0}),Object(a.jsxs)(O.a,{item:!0,xs:12,sm:8,style:{paddingLeft:15},children:[Object(a.jsx)(b.a,{variant:"h6",children:n.data.title}),Object(a.jsx)("div",{dangerouslySetInnerHTML:{__html:n.data.content}})]})]})}),s?s.map((function(e){return Object(a.jsx)(q,{response:e,api:t},e._id)})):Object(a.jsx)(M.a,{width:"100%",height:150})]})},q=function(e){var t=e.response,n=e.api,c=Object(o.useState)(),i=Object(u.a)(c,2),s=i[0],r=i[1];return Object(o.useEffect)((function(){n.getObjects("users","_id=".concat(t.data.agent)).then((function(e){return r(e[0])}))}),[t,n]),Object(a.jsxs)(O.a,{container:!0,style:{marginTop:15},spacing:3,children:[Object(a.jsx)(O.a,{item:!0,xs:8,children:Object(a.jsx)(m,{withBigMargin:!0,children:Object(a.jsx)("div",{dangerouslySetInnerHTML:{__html:t.data.content}})})}),Object(a.jsx)(O.a,{item:!0,xs:4,children:Object(a.jsx)(m,{withBigMargin:!0,children:s?Object(a.jsxs)(O.a,{container:!0,spacing:3,direction:"row",justify:"center",alignItems:"center",children:[Object(a.jsx)(O.a,{item:!0,xs:3,children:Object(a.jsx)(z,{withShadow:!0,size:"xs",image:"".concat(Object({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}).REACT_APP_URL,"/").concat(s.data.picture),fallBackOnLocalhost:!0})}),Object(a.jsx)(O.a,{item:!0,xs:9,style:{textAlign:"center"},children:Object(a.jsx)(b.a,{variant:"body1",children:s.data.full_name})})]}):Object(a.jsx)(M.a,{width:"100%"})})})]})},X=K,G=function(e){var t=e.api,n=Object(A.f)(),c=Object(o.useState)(),i=Object(u.a)(c,2),s=i[0],r=i[1];return Object(o.useEffect)((function(){t.getObjects("support-tickets","person=".concat(t.person._id)).then((function(e){return r(e)}))}),[t]),Object(a.jsxs)(m,{title:"Hi ".concat(t.person.data.first_name),children:[Object(a.jsxs)(b.a,{variant:"body1",children:["Welcome to ",t.config.app_name,"."]}),Object(a.jsx)(b.a,{variant:"body1",children:"You can view your tickets here and read up on them, or add new tickets."}),s&&Object(a.jsxs)(W.a,{children:[Object(a.jsx)(F.a,{children:"Your open tickets"}),s.map((function(e){return Object(a.jsx)(B.a,{button:!0,onClick:function(){n.push("/tickets/".concat(e.data.name))},children:Object(a.jsx)(U.a,{children:e.data.title})},e._id)}))]})]})},Q={tickets:function(e){var t=e.api,n=e.detailId,c=Object(A.f)(),i=Object(o.useState)(),s=Object(u.a)(i,2),r=s[0],l=s[1],d=Object(o.useState)(),j=Object(u.a)(d,2),b=j[0],h=j[1];return Object(o.useEffect)((function(){t.getObjects("support-tickets","person=".concat(t.person._id)).then((function(e){return l(e)}))}),[t]),Object(o.useEffect)((function(){h(r&&Object(C.find)(r,(function(e){return e.data.name===n})))}),[n,r]),Object(a.jsxs)(O.a,{container:!0,spacing:3,children:[Object(a.jsx)(O.a,{item:!0,xs:12,sm:b?3:12,children:Object(a.jsx)(m,{withBigMargin:!0,withoutPadding:!0,children:r?Object(a.jsxs)(W.a,{children:[Object(a.jsx)(F.a,{children:"Your open tickets"}),r.map((function(e){return Object(a.jsx)(B.a,{button:!0,onClick:function(){c.push("/tickets/".concat(e.data.name))},selected:n===e.data.name,children:Object(a.jsx)(U.a,{children:e.data.title})},e._id)}))]}):Object(a.jsx)(M.a,{})})}),b&&Object(a.jsx)(Y,{api:t,ticket:b})]})}},Z=function(){return Object(a.jsx)(D,{pages:c})};r.a.render(Object(a.jsx)(i.a.StrictMode,{children:Object(a.jsx)(Z,{})}),document.getElementById("root"))}},[[62,1,2]]]);
//# sourceMappingURL=main.d2f852f9.chunk.js.map