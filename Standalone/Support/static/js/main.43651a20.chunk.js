(this["webpackJsonpsupport-dashboard"]=this["webpackJsonpsupport-dashboard"]||[]).push([[0],{32:function(e,t,n){e.exports={input:"styles_input__Awl1k"}},33:function(e,t,n){e.exports={picture:"styles_picture__jko9n",xs:"styles_xs__3-13V",withShadow:"styles_withShadow__3518o",sm:"styles_sm__1s8n9",md:"styles_md__1IDal",lg:"styles_lg__3X1oC",xl:"styles_xl__3_9tj"}},43:function(e,t,n){e.exports={root:"styles_root__1Fa0k",hoverable:"styles_hoverable__31MfH",image:"styles_image__1F_oo"}},47:function(e,t,n){e.exports={root:"styles_root__2w3r0"}},48:function(e,t,n){e.exports={root:"Layout_root__27KTH"}},57:function(e,t,n){},66:function(e,t,n){"use strict";n.r(t);var c={};n.r(c),n.d(c,"layout",(function(){return X})),n.d(c,"home",(function(){return G})),n.d(c,"default",(function(){return Q}));var a=n(2),o=n(0),i=n.n(o),s=n(18),r=n.n(s),l=(n(57),n(16)),u=n(9),d=n(42),j=function(e,t){return new Promise((function(n,c){fetch(e,{method:"POST",mode:"cors",cache:"no-cache",credentials:"same-origin",headers:{"Content-Type":"application/json"},redirect:"follow",referrerPolicy:"no-referrer",body:JSON.stringify(t||{})}).then((function(e){return e.json()})).then((function(e){n(e)}))}))},h=n(86),b=n(34),p=n(85),O=n(87),m=n(43),f=n.n(m),g=function(e){var t=e.children,n=(e.withBigMargin,e.title),c=e.withoutPadding,o=e.centerTitle,i=e.titleDivider;return Object(a.jsx)("div",{className:"Card ".concat(f.a.root),children:Object(a.jsxs)("div",{style:{padding:!c&&15},children:[n&&Object(a.jsxs)(a.Fragment,{children:[Object(a.jsx)(b.a,{variant:"h6",style:{textAlign:o?"center":"left"},children:n}),i&&Object(a.jsx)(p.a,{style:{marginBottom:10,marginTop:5}})]}),t]})})},x=n(94),v=n(32),y=n.n(v),_=function(e){var t=e.placeholder,n=e.label,c=e.value,i=e.onChange,s=e.type,r=e.style,d=e.autoFocus,j=e.readOnly,h=e.onEnter,b=e.onEscape,p=e.onKeyPress,O=e.name,m=e.spacing,f=(e.startAdornment,e.endAdornment,Object(o.useState)("")),g=Object(u.a)(f,2),v=g[0],_=g[1];return Object(o.useEffect)((function(){_(c)}),[c]),"textarea"===s?Object(a.jsx)(x.a,{"aria-label":"minimum height",rowsMin:3,placeholder:n,value:v,onChange:function(e){_(e.target.value),i&&i(e.target.value)},className:y.a.input}):n?Object(a.jsx)("div",{style:{marginBottom:m&&5*m,marginTop:m&&5*m},children:Object(a.jsxs)("label",{style:{width:"100%"},children:[n,Object(a.jsx)("input",{name:O,autoFocus:d,style:r,type:s||"text",className:y.a.input,placeholder:t,disabled:j||!1,value:v,onChange:function(e){_(e.target.value),i&&!j&&i(e.target.value)},onKeyDown:function(e){p&&p(v),"Enter"===e.key&&h&&h(v),"Escape"===e.key&&b&&b(v)}})]})}):Object(a.jsx)("input",{style:Object(l.a)(Object(l.a)({},r),{},{marginBottom:m&&5*m,marginTop:m&&5*m}),name:O,className:y.a.input,type:s||"text",placeholder:t,value:v,disabled:j||!1,autoFocus:d,onChange:function(e){_(e.target.value),i&&!j&&i(e.target.value)},onKeyDown:function(e){p&&p(v),"Enter"===e.key&&h&&h(v),"Escape"===e.key&&b&&b(v)}})},w=n(47),k=n.n(w),S=function(e){var t=e.config,n=e.api,c=Object(o.useState)({username:"",password:""}),i=Object(u.a)(c,2),s=i[0],r=i[1],d=Object(o.useState)(),j=Object(u.a)(d,2),m=j[0],f=j[1];return Object(a.jsx)(h.a,{container:!0,direction:"row",justify:"center",alignItems:"center",className:k.a.root,style:{backgroundImage:"url(".concat(t.login.background,")"),backgroundColor:"rgba(".concat(t.color.r,",").concat(t.color.g,",").concat(t.color.b,",0.6)")},children:Object(a.jsx)(h.a,{item:!0,xs:12,md:3,children:Object(a.jsxs)(g,{title:t.app_name,children:[Object(a.jsx)(b.a,{variant:"body1",children:t.login.welcomeText||"Log into ".concat(t.app_name," using your appbox credentials.")}),m&&Object(a.jsxs)(a.Fragment,{children:[Object(a.jsx)(p.a,{style:{margin:"5px 0"}}),Object(a.jsxs)(b.a,{variant:"body2",style:{color:"red"},children:[Object(a.jsx)("b",{children:"Error: "}),m]}),Object(a.jsx)(p.a,{style:{margin:"5px 0"}})]}),Object(a.jsx)(_,{label:"Username",value:s.username,onChange:function(e){return r(Object(l.a)(Object(l.a)({},s),{},{username:e}))},style:{marginTop:15}}),Object(a.jsx)(_,{label:"Password",value:s.password,type:"password",onChange:function(e){return r(Object(l.a)(Object(l.a)({},s),{},{password:e}))},style:{marginTop:15}}),Object(a.jsx)(O.a,{fullWidth:!0,variant:"contained",color:"primary",style:{marginTop:15},onClick:function(){n.signIn(s).then((function(e){return window.location.reload()}),(function(e){return f(e)}))},children:"Sign in"})]})})})},I=n(88),N=function(e){var t=e.label;return Object(a.jsxs)("div",{className:"center",style:{width:"100%",height:"100%"},children:[Object(a.jsx)(I.a,{}),t&&Object(a.jsxs)(a.Fragment,{children:[Object(a.jsx)("br",{}),t]})]})},T=n(31),C=n(26),E=n(7),P=n(89),B=n(49),M=new function e(){var t=this;Object(d.a)(this,e),this.key=void 0,this.url="https://appbox.vicvancooten.nl",this.appCode="4059a1hhki0ceaa4",this.appName="Support",this.token=void 0,this.auth=void 0,this.user=void 0,this.person=void 0,this.config=void 0,this.signIn=function(e){return new Promise((function(n,c){j("".concat(t.url,"/api/system/signIn"),{user:e,appName:t.appName,standAloneCode:t.appCode}).then((function(e){console.log("API feedback",e),e.success?(t.setToken(e.token,e.username),localStorage.setItem("token",e.token),localStorage.setItem("username",e.username),n(e.token)):c(e.reason)}))}))},this.setToken=function(e,n){t.token=e,t.auth={token:e,username:n,signInAs:"person"}},this.getPerson=function(){return new Promise((function(e,n){j("".concat(t.url,"/api/people/read?email=").concat(t.auth.username),{auth:t.auth}).then((function(n){e(n[0]),t.person=n[0]}))}))},this.getObjects=function(e,n){return new Promise((function(c,a){j("".concat(t.url,"/api/").concat(e,"/read?").concat(n),{auth:t.auth}).then((function(e){c(e)}))}))}},A=function(e){var t=e.pages,n=Object(o.useState)(),c=Object(u.a)(n,2),i=c[0],s=c[1],r=Object(o.useState)(),d=Object(u.a)(r,1)[0],j=Object(o.useState)(),h=Object(u.a)(j,2),b=h[0],p=h[1],O=Object(o.useState)(!0),m=Object(u.a)(O,2),f=m[0],g=m[1];return Object(o.useEffect)((function(){!function(e){var t="https://appbox.vicvancooten.nl",n="4059a1hhki0ceaa4",c="Support",a=localStorage.getItem("config");a?(e(JSON.parse(a)),fetch("".concat(t,"/api/system/standalone/").concat(c,"-").concat(n)).then((function(e){return e.json()})).then((function(t){JSON.parse(a).configVersion!==t.configVersion&&(localStorage.setItem("config",JSON.stringify(t)),e(t))}),(function(t){e(t)}))):fetch("".concat(t,"/api/system/standalone/").concat(c,"-").concat(n)).then((function(e){return e.json()})).then((function(t){localStorage.setItem("config",JSON.stringify(t)),e(t)}),(function(t){e(t)}))}((function(e){s(e),M.config=e})),d||b||(M.setToken(localStorage.getItem("token"),localStorage.getItem("username")),M.token?"people"===(M.config.signInWith||"people")?M.getPerson().then((function(e){p(e),g(!1)})):console.log("Todo: sign in user"):g(!1))}),[d,b]),Object(a.jsx)(P.a,{theme:Object(B.a)({palette:{type:window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"}}),children:i?i.requireSignIn?d||b?Object(a.jsx)(t.layout,{api:M,children:Object(a.jsx)(C.a,{children:Object(a.jsxs)(E.c,{children:[Object(T.map)(t.default,(function(e,t){return Object(a.jsx)(E.a,{path:"/".concat(t,"/:detailId?"),render:function(t){return Object(a.jsx)(e,Object(l.a)(Object(l.a)({},t),{},{detailId:t.match.params.detailId,api:M}))}},t)})),Object(a.jsx)(E.a,{path:"/",children:Object(a.jsx)(t.home,{api:M})})]})})}):f?Object(a.jsx)(N,{}):Object(a.jsx)(S,{config:i,api:M}):Object(a.jsx)(t.layout,{api:M,children:"Test"}):Object(a.jsx)(N,{})})},F=n(48),L=n.n(F),J=function(e){var t,n,c,o,i,s,r,l,u=e.api,d=e.children;return Object(a.jsx)(h.a,{container:!0,direction:"row",justify:"center",alignItems:"center",className:L.a.root,style:{backgroundImage:"url(".concat(null===u||void 0===u||null===(t=u.config)||void 0===t||null===(n=t.login)||void 0===n?void 0:n.background),backgroundColor:"rgba(".concat(null===u||void 0===u||null===(c=u.config)||void 0===c||null===(o=c.color)||void 0===o?void 0:o.r,",").concat(null===u||void 0===u||null===(i=u.config)||void 0===i||null===(s=i.color)||void 0===s?void 0:s.g,",").concat(null===u||void 0===u||null===(r=u.config)||void 0===r||null===(l=r.color)||void 0===l?void 0:l.b,",0.6)")},children:Object(a.jsx)(h.a,{item:!0,xs:12,md:8,children:d})})},H=n(90),D=n(91),K=n(95),z=n(92),V=n(93),W=n(33),Y=n.n(W),q=function(e){var t=e.size,n=e.withShadow,c=e.image,o=(e.shadowRadius,e.className),i=e.style,s=e.fallBackOnLocalhost;return Object(a.jsx)("div",{className:"".concat(Y.a[t]).concat(o?" ".concat(o):""),style:i,children:Object(a.jsx)("div",{className:"".concat(Y.a.picture," ").concat(n&&Y.a.withShadow),style:{backgroundImage:s?(null===c||void 0===c?void 0:c.match("localhost"))?"url(https://picsum.photos/200)":"url(".concat(c,")"):"url(".concat(c||"https://picsum.photos/seed/13/300/400",")")}})})},R=function(e){var t=e.api,n=e.ticket,c=Object(o.useState)(),i=Object(u.a)(c,2),s=i[0],r=i[1];return Object(o.useEffect)((function(){t.getObjects("support-responses","ticket=".concat(n._id)).then((function(e){return r(e)}))}),[n,t]),Object(a.jsxs)(h.a,{item:!0,xs:12,sm:9,className:"scrollIndependently",children:[Object(a.jsx)(g,{withBigMargin:!0,children:Object(a.jsxs)(h.a,{container:!0,children:[Object(a.jsxs)(h.a,{item:!0,xs:12,sm:3,style:{textAlign:"center"},children:[Object(a.jsx)(q,{withShadow:!0,size:"sm",style:{margin:"0 auto"},image:"".concat("https://appbox.vicvancooten.nl","/").concat(t.person.data.picture.url),fallBackOnLocalhost:!0}),Object(a.jsx)(b.a,{variant:"body1",children:t.person.data.full_name})]}),Object(a.jsx)(p.a,{orientation:"vertical",flexItem:!0}),Object(a.jsxs)(h.a,{item:!0,xs:12,sm:8,style:{paddingLeft:15},children:[Object(a.jsx)(b.a,{variant:"h6",children:n.data.title}),Object(a.jsx)("div",{dangerouslySetInnerHTML:{__html:n.data.content}})]})]})}),s?s.map((function(e){return Object(a.jsx)(U,{response:e,api:t},e._id)})):Object(a.jsx)(V.a,{width:"100%",height:150})]})},U=function(e){var t=e.response,n=e.api,c=Object(o.useState)(),i=Object(u.a)(c,2),s=i[0],r=i[1];return Object(o.useEffect)((function(){n.getObjects("users","_id=".concat(t.data.agent)).then((function(e){return r(e[0])}))}),[t,n]),Object(a.jsxs)(h.a,{container:!0,style:{marginTop:15},spacing:3,children:[Object(a.jsx)(h.a,{item:!0,xs:8,children:Object(a.jsx)(g,{withBigMargin:!0,children:Object(a.jsx)("div",{dangerouslySetInnerHTML:{__html:t.data.content}})})}),Object(a.jsx)(h.a,{item:!0,xs:4,children:Object(a.jsx)(g,{withBigMargin:!0,children:s?Object(a.jsxs)(h.a,{container:!0,spacing:3,direction:"row",justify:"center",alignItems:"center",children:[Object(a.jsx)(h.a,{item:!0,xs:3,children:Object(a.jsx)(q,{withShadow:!0,size:"xs",image:"".concat("https://appbox.vicvancooten.nl","/").concat(s.data.picture),fallBackOnLocalhost:!0})}),Object(a.jsx)(h.a,{item:!0,xs:9,style:{textAlign:"center"},children:Object(a.jsx)(b.a,{variant:"body1",children:s.data.full_name})})]}):Object(a.jsx)(V.a,{width:"100%"})})})]})},X=J,G=function(e){var t=e.api,n=Object(E.f)(),c=Object(o.useState)(),i=Object(u.a)(c,2),s=i[0],r=i[1];return Object(o.useEffect)((function(){t.getObjects("support-tickets","person=".concat(t.person._id)).then((function(e){return r(e)}))}),[t]),Object(a.jsxs)(g,{title:"Hi ".concat(t.person.data.first_name),children:[Object(a.jsxs)(b.a,{variant:"body1",children:["Welcome to ",t.config.app_name,"."]}),Object(a.jsx)(b.a,{variant:"body1",children:"You can view your tickets here and read up on them, or add new tickets."}),s&&Object(a.jsxs)(H.a,{children:[Object(a.jsx)(D.a,{children:"Your open tickets"}),s.map((function(e){return Object(a.jsx)(K.a,{button:!0,onClick:function(){n.push("/tickets/".concat(e.data.name))},children:Object(a.jsx)(z.a,{children:e.data.title})},e._id)}))]})]})},Q={tickets:function(e){var t=e.api,n=e.detailId,c=Object(E.f)(),i=Object(o.useState)(),s=Object(u.a)(i,2),r=s[0],l=s[1],d=Object(o.useState)(),j=Object(u.a)(d,2),b=j[0],p=j[1];return Object(o.useEffect)((function(){t.getObjects("support-tickets","person=".concat(t.person._id)).then((function(e){return l(e)}))}),[t]),Object(o.useEffect)((function(){p(r&&Object(T.find)(r,(function(e){return e.data.name===n})))}),[n,r]),Object(a.jsxs)(h.a,{container:!0,spacing:3,children:[Object(a.jsx)(h.a,{item:!0,xs:12,sm:b?3:12,children:Object(a.jsx)(g,{withBigMargin:!0,withoutPadding:!0,children:r?Object(a.jsxs)(H.a,{children:[Object(a.jsx)(D.a,{children:"Your open tickets"}),r.map((function(e){return Object(a.jsx)(K.a,{button:!0,onClick:function(){c.push("/tickets/".concat(e.data.name))},selected:n===e.data.name,children:Object(a.jsx)(z.a,{children:e.data.title})},e._id)}))]}):Object(a.jsx)(V.a,{})})}),b&&Object(a.jsx)(R,{api:t,ticket:b})]})}},Z=function(){return Object(a.jsx)(A,{pages:c})};n(63).config(),r.a.render(Object(a.jsx)(i.a.StrictMode,{children:Object(a.jsx)(Z,{})}),document.getElementById("root"))}},[[66,1,2]]]);
//# sourceMappingURL=main.43651a20.chunk.js.map